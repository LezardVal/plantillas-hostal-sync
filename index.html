<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plantillas Dinámicas Hostal</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background-color: #f4f4f9; }
        .template { margin-bottom: 25px; padding: 15px; border: 1px solid #ddd; border-radius: 8px; background-color: white; }
        h2 { color: #333; font-size: 1.2em; margin-top: 0; }
        .content { white-space: pre-wrap; margin-bottom: 10px; border: 1px dashed #ccc; padding: 10px; background-color: #fafafa; }
        .copy-btn { background-color: #007bff; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; transition: background-color 0.3s; }
        .copy-btn:hover { background-color: #0056b3; }
    </style>
</head>
<body>

    <h1>Plantillas TCH (Sincronizadas)</h1>
    <div id="templates-container">Cargando plantillas...</div>
    
    <script>
        // TU URL DE APPS SCRIPT (Ya está corregida aquí)
        const SHEET_URL = 'https://script.google.com/macros/s/AKfycbys5nLM12ACSSEFR2WFlbqEG0EOmDXPSZkqJOlFgd1kh_kc10ywBQxftV4SbRBp7Nj1Mg/exec';
        
        // Función de copiado
        function copiarTexto(element, button) {
            const content = element.innerText;
            navigator.clipboard.writeText(content).then(() => {
                const originalText = button.innerText;
                button.innerText = '¡Copiado!';
                setTimeout(() => {
                    button.innerText = originalText;
                }, 1000);
            }).catch(err => {
                alert('Error al copiar. Asegúrate de que estás en un sitio web seguro (HTTPS).');
            });
        }

        // Función para cargar los datos JSON
        async function loadTemplates() {
            const container = document.getElementById('templates-container');
            container.innerHTML = 'Cargando datos...';
            
            try {
                // 1. Petición a la URL (Apps Script devuelve JSON)
                const response = await fetch(SHEET_URL);
                
                // 2. CORRECCIÓN: Usar .json() en lugar de .text()
                const templates = await response.json(); 
                
                let htmlContent = '';
                
                // 3. Iterar sobre la lista de plantillas
                templates.forEach((template, index) => {
                    // Accedemos a las propiedades 'keyword' y 'text' que definimos en el Apps Script
                    const keyword = template.keyword; 
                    const templateText = template.text; 
                    
                    if (keyword && templateText) {
                         const id = `t-${index}`;
                         htmlContent += `
                            <div class="template">
                                <h2>${keyword}</h2>
                                <div id="${id}" class="content">${templateText}</div>
                                <button class="copy-btn" onclick="copiarTexto(document.getElementById('${id}'), this)">✅ Copiar ${keyword}</button>
                            </div>
                        `;
                    }
                });
                
                container.innerHTML = htmlContent;
                
            } catch (error) {
                console.error("Error al cargar:", error);
                container.innerHTML = 'Error: No se pudieron cargar las plantillas. Revisa la consola para más detalles.';
            }
        }

        loadTemplates(); 
    </script>
</body>
</html>
